# 九点圆问题

由于今天考试爆零了，但是$T1、T4$都是结论题，况且$T1$还是一个经典的几何题（九点圆），自己的解析几何在考场上没有推出来，赛后也一直卡住很长时间，所以感到非常气愤，

然而我一直都相信**没有什么是代数解决不了的**，所以就有了下文。
我将会以极其普通的思路和不需动脑子的代数方法解决九点圆的圆心坐标问题。

### 目的：

给定$\triangle ABC$的三点坐标$(a_x,a_y),(b_x,b_y),(c_x,c_y)$，找到三条边的中点$D(x_1,y_1)、E(x_2,y_2)、F(x_3,y_3)$
，求出$\triangle DEF$的外接圆圆心坐标，也就是$\triangle ABC$的九点圆圆心坐标。

### 结论：

钦定$\triangle ABC$的圆心为原点$(0,0)$时。设$\triangle DEF$的圆心为$O$，则$O=\frac{A+B+C}{2}$，其他情况通过平移可得。

### 推导：

根据$\triangle ABC$的圆心限制，首先得到$a_x^2+a_y^2=b_x^2+b_y^2=c_x^2+c_y^2$
由$x_1=\frac{a_x+b_x}{2}，y_1=\frac{a_y+b_y}{2}$，可知$a_x=x_1+x_2-x_3，b_x=x_1+x_3-x_2，c_x=x_2+x_3-x_1$，$y$同理。
则$(x_1+x_2-x_3)^2+(y_1+y_2-y_3)^2=(x_1+x_3-x_2)^2+(y_1+y_3-y_2)^2……$
通过化简，得到下列重要转换式：
$$
x_1(x_2-x_3)=y_1(y_3-y_2) \\
x_2(x_3-x_1)=y_2(y_1-y_3) \\
x_3(x_1-x_2)=y_3(y_2-y_1) \\
$$
设$O$坐标为$(a,b)$，根据圆的方程易得
$$(x_1-a)^2+(y_1-b)^2=(x_2-a)^2+(y_2-b)^2=(x_3-a)^2+(y_3-b)^2=r^2$$
通过加减消元，得
$$
\begin{align}
2(x_1-x_2)a+2(y_1-y_2)b=(x_1^2+y_1^2)-(x_2^2+y_2^2) \\
2(x_2-x_3)a+2(y_2-y_3)b=(x_2^2+y_2^2)-(x_3^2+y_3^2) \\
2(x_3-x_1)a+2(y_3-y_1)b=(x_3^2+y_3^2)-(x_1^2+y_1^2) \\
\end{align}
$$
解得
$$
\begin{aligned}
2a= \frac{(y_2-y_3)[(x_1^2+y_1^2)-(x_2^2+y_2^2)]-(y_1-y_2)[(x_2^2+y_2^2)-(x_3^2+y_3^2)]}{(y_2-y_3)(x_1-x_2)-(y_1-y_2)(x_2-x_3)} \\
2b= \frac{(x_2-x_3)[(x_1^2+y_1^2)-(x_2^2+y_2^2)]-(x_1-x_2)[(x_2^2+y_2^2)-(x_3^2+y_3^2)]}{(x_2-x_3)(y_1-y_2)-(x_1-x_2)(y_2-y_3)} \\
\end{aligned}
$$
到这里貌似就推不动了，但是发现上面的转换式还没有用，尝试把分母可视化，即通过大力因式分解把分子化为分母的倍数。
以$b$为例
$$
\begin{aligned}
分子&={(x_2-x_3)(x_1-x_2)(x_1+x_2)+(x_2-x_3)(y_1-y_2)(y_1+y_2)-(x_1-x_2)(x_2-x_3)(x_2+x_3)-(x_1-x_2)(y_2-y_3)(y_2+y_3)} \\
&={(x_2-x_3)(x_1-x_2)(x_1+x_2)-(x_1-x_2)(x_2-x_3)(x_2+x_3)+(x_2-x_3)(y_1-y_2)(y_1+y_2)-(x_1-x_2)(y_2-y_3)(y_2+y_3)} \\
&={(x_1-x_2)(x_2-x_3)(x_1-x_3)+(x_2-x_3)(y_1-y_2)(y_1+y_2)-(x_1-x_2)(y_2-y_3)(y_2+y_3)} \\
\end{aligned}
$$
发现右侧部分的式子非常接近分母，而第一项中$x$的次数甚至达到了$3$，显然需要对这一部分调整。
$$
\begin{aligned}
(x_1-x_2)(x_2-x_3)(x_1-x_3)&=x_1^2-x_1x_2x_3-x_1^2x_3+x_3^2x_1-x_2^2x_1+x_2^2x_3+x_1x_2x_3-x_3^2x_2 \\
&=x_1^2(x_2-x_3)+x_2^2(x_3-x_1)+x_3^2(x_1-x_2) \\
&=x_1y_1(y_3-y_2)+x_2y_2(y_1-y_3)+x_3y_3(y_2-y_1) \quad（利用了一开始给出的转换式） \\
&=x_1y_1y_3-x_1y_1y_2+x_2y_1y_2-x_2y_2y_3+x_3y_2y_3-x_3y_1y_3 \\
&=(x_2y_1y_3-x_2y_2y_3-x_3y_1y_3+x_3y_2y_3)-(x_1y_1y_2-x_1y_1y_3-x_2y_1y_2+x_2y_1y_3) \quad （前后添项、去项，增添了x_2y_1y_3项） \\
&=y_3(x_2-x_3)(y_1-y_2)-y_1(x_1-x_2)(y_2-y_3) \\
\end{aligned}
$$
代入原式，分子$=(x_2-x_3)(y_1-y_2)(y_1+y_2+y_3)-(x_1-x_2)(y_2-y_3)(y_1+y_2+y_3)$
因此，原式$=y_1+y_2+y_3$
同理可得，**$a=\frac{x_1+x_2+x_3}{2}，b=\frac{y_1+y_2+y_3}{2}$**
因为$x_1+x_2+x_3=a_x+b_x+c_x, y_1+y_2+y_3=a_y+b_y+c_y$，所以也有 **$a=\frac{a_x+b_x+c_x}{2}，b=\frac{a_y+b_y+c_y}{2}$**

### 证毕。
